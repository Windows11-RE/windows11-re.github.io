<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub 配置 - 后台管理系统</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <nav class="container">
            <h1 class="logo">博客后台</h1>
            <ul class="nav-links">
                <li><a href="index.html">前台首页</a></li>
                <li><a href="admin.html">文章管理</a></li>
                <li><a href="github-config.html" class="active">GitHub 配置</a></li>
                <li><a href="#" onclick="logout(); return false;" class="logout-link">🚪 登出</a></li>
            </ul>
        </nav>
    </header>

    <main class="container">
        <div class="config-container">
            <div class="config-header">
                <h2>⚙️ GitHub 存储配置</h2>
                <p class="config-description">配置 GitHub 作为数据存储，实现跨设备同步</p>
            </div>

            <div class="config-status" id="config-status">
                <!-- 状态信息 -->
            </div>

            <form id="github-config-form" class="config-form">
                <div class="form-group">
                    <label for="github-owner">GitHub 用户名 *</label>
                    <input type="text" id="github-owner" placeholder="例如: username" required>
                    <small>你的 GitHub 用户名</small>
                </div>

                <div class="form-group">
                    <label for="github-repo">仓库名 *</label>
                    <input type="text" id="github-repo" placeholder="例如: blog-data" required>
                    <small>用于存储数据的仓库名（建议创建私有仓库）</small>
                </div>

                <div class="form-group">
                    <label for="github-token">Personal Access Token *</label>
                    <input type="password" id="github-token" placeholder="ghp_xxxxxxxxxxxx" required>
                    <small>
                        需要 <code>repo</code> 权限。
                        <a href="https://github.com/settings/tokens/new" target="_blank">创建 Token</a>
                    </small>
                </div>

                <div class="form-group">
                    <label for="github-branch">分支名</label>
                    <input type="text" id="github-branch" placeholder="main" value="main">
                    <small>数据存储的分支（默认: main）</small>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn">💾 保存配置</button>
                    <button type="button" class="btn btn-secondary" onclick="testConnection()">🔍 测试连接</button>
                </div>
            </form>

            <div class="sync-section">
                <h3>📡 数据同步</h3>
                <div class="sync-actions">
                    <button class="btn" onclick="syncToGitHub()">⬆️ 推送到 GitHub</button>
                    <button class="btn btn-secondary" onclick="pullFromGitHub()">⬇️ 从 GitHub 拉取</button>
                    <button class="btn btn-secondary" onclick="viewGitHubData()">👁️ 查看 GitHub 数据</button>
                </div>
                <div id="sync-status" class="sync-status"></div>
            </div>

            <div class="help-section">
                <h3>📖 配置指南</h3>
                <ol>
                    <li>在 GitHub 创建一个新仓库（建议私有）</li>
                    <li>生成 Personal Access Token（需要 <code>repo</code> 权限）</li>
                    <li>填写上述配置信息</li>
                    <li>点击"测试连接"验证配置</li>
                    <li>点击"推送到 GitHub"上传现有数据</li>
                </ol>
                
                <div class="help-links">
                    <a href="https://github.com/new" target="_blank" class="help-link">
                        📦 创建新仓库
                    </a>
                    <a href="https://github.com/settings/tokens/new" target="_blank" class="help-link">
                        🔑 创建 Token
                    </a>
                    <a href="GITHUB_STORAGE_GUIDE.md" target="_blank" class="help-link">
                        📚 详细文档
                    </a>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 我的博客. 保留所有权利.</p>
        </div>
    </footer>

    <script src="js/auth.js"></script>
    <script src="js/github-storage.js"></script>
    <script src="js/bing-wallpaper.js"></script>
    <script src="js/github-config.js"></script>
    <script>
        // 应用必应每日一图背景
        document.addEventListener('DOMContentLoaded', async () => {
            await applyBingWallpaperToBody({
                overlay: true,
                overlayColor: 'rgba(255, 255, 255, 0.15)'
            });
            document.body.classList.add('has-wallpaper');
        });
    </script>
</body>
</html>
