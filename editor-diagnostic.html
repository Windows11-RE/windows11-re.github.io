<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¼–è¾‘å™¨è¯Šæ–­å·¥å…·</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 30px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
        }
        .section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        button {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #5568d3;
        }
        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-left: 4px solid #ccc;
        }
    </style>
</head>
<body>
    <h1>ğŸ” Quill ç¼–è¾‘å™¨è¯Šæ–­å·¥å…·</h1>
    
    <div class="section">
        <h2>1. ç¯å¢ƒæ£€æµ‹</h2>
        <div id="env-check"></div>
    </div>
    
    <div class="section">
        <h2>2. CDN èµ„æºåŠ è½½æµ‹è¯•</h2>
        <div id="cdn-check"></div>
        <button onclick="testCDN()">é‡æ–°æµ‹è¯• CDN</button>
    </div>
    
    <div class="section">
        <h2>3. Quill åº“æ£€æµ‹</h2>
        <div id="quill-check"></div>
    </div>
    
    <div class="section">
        <h2>4. ç¼–è¾‘å™¨åˆå§‹åŒ–æµ‹è¯•</h2>
        <div id="init-check"></div>
        <div id="test-editor" style="min-height: 200px; border: 1px solid #ddd; margin-top: 10px;"></div>
        <button onclick="testInit()">æµ‹è¯•åˆå§‹åŒ–</button>
    </div>
    
    <div class="section">
        <h2>5. æ§åˆ¶å°æ—¥å¿—</h2>
        <pre id="console-log"></pre>
    </div>

    <!-- å°è¯•ä»å¤šä¸ª CDN åŠ è½½ Quill -->
    <script>
        let logs = [];
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            logs.push(`[${timestamp}] ${type.toUpperCase()}: ${message}`);
            updateConsoleLog();
            console.log(message);
        }
        
        function updateConsoleLog() {
            document.getElementById('console-log').textContent = logs.join('\n');
        }
        
        // ç¯å¢ƒæ£€æµ‹
        function checkEnvironment() {
            const envCheck = document.getElementById('env-check');
            let html = '';
            
            html += `<div class="test-result">
                <strong>æµè§ˆå™¨ï¼š</strong> ${navigator.userAgent}
            </div>`;
            
            html += `<div class="test-result">
                <strong>åœ¨çº¿çŠ¶æ€ï¼š</strong> ${navigator.onLine ? 'âœ… åœ¨çº¿' : 'âŒ ç¦»çº¿'}
            </div>`;
            
            html += `<div class="test-result">
                <strong>JavaScript å¯ç”¨ï¼š</strong> âœ… æ˜¯
            </div>`;
            
            envCheck.innerHTML = html;
            log('ç¯å¢ƒæ£€æµ‹å®Œæˆ');
        }
        
        // CDN æµ‹è¯•
        function testCDN() {
            const cdnCheck = document.getElementById('cdn-check');
            cdnCheck.innerHTML = '<div class="info">æ­£åœ¨æµ‹è¯• CDN è¿æ¥...</div>';
            
            const cdns = [
                {
                    name: 'jsDelivr',
                    css: 'https://cdn.jsdelivr.net/npm/quill@1.3.6/dist/quill.snow.css',
                    js: 'https://cdn.jsdelivr.net/npm/quill@1.3.6/dist/quill.js'
                },
                {
                    name: 'Quill å®˜æ–¹',
                    css: 'https://cdn.quilljs.com/1.3.6/quill.snow.css',
                    js: 'https://cdn.quilljs.com/1.3.6/quill.js'
                },
                {
                    name: 'unpkg',
                    css: 'https://unpkg.com/quill@1.3.6/dist/quill.snow.css',
                    js: 'https://unpkg.com/quill@1.3.6/dist/quill.js'
                }
            ];
            
            let results = '';
            let testCount = 0;
            
            cdns.forEach(cdn => {
                // æµ‹è¯• JS æ–‡ä»¶
                fetch(cdn.js, { method: 'HEAD' })
                    .then(response => {
                        testCount++;
                        if (response.ok) {
                            results += `<div class="status success">âœ… ${cdn.name} - å¯ç”¨ (${response.status})</div>`;
                            log(`${cdn.name} CDN å¯ç”¨`);
                        } else {
                            results += `<div class="status error">âŒ ${cdn.name} - ä¸å¯ç”¨ (${response.status})</div>`;
                            log(`${cdn.name} CDN ä¸å¯ç”¨`, 'error');
                        }
                        
                        if (testCount === cdns.length) {
                            cdnCheck.innerHTML = results;
                        }
                    })
                    .catch(error => {
                        testCount++;
                        results += `<div class="status error">âŒ ${cdn.name} - è¿æ¥å¤±è´¥: ${error.message}</div>`;
                        log(`${cdn.name} CDN è¿æ¥å¤±è´¥: ${error.message}`, 'error');
                        
                        if (testCount === cdns.length) {
                            cdnCheck.innerHTML = results;
                        }
                    });
            });
        }
        
        // Quill åº“æ£€æµ‹
        function checkQuill() {
            const quillCheck = document.getElementById('quill-check');
            
            if (typeof Quill === 'undefined') {
                quillCheck.innerHTML = '<div class="status error">âŒ Quill åº“æœªåŠ è½½</div>';
                log('Quill åº“æœªåŠ è½½', 'error');
            } else {
                quillCheck.innerHTML = `
                    <div class="status success">âœ… Quill åº“å·²åŠ è½½</div>
                    <div class="test-result"><strong>ç‰ˆæœ¬ï¼š</strong> ${Quill.version || 'æœªçŸ¥'}</div>
                    <div class="test-result"><strong>å¯ç”¨ä¸»é¢˜ï¼š</strong> ${Object.keys(Quill.imports).filter(k => k.includes('theme')).join(', ') || 'æœªçŸ¥'}</div>
                `;
                log(`Quill åº“å·²åŠ è½½ï¼Œç‰ˆæœ¬: ${Quill.version}`);
            }
        }
        
        // åˆå§‹åŒ–æµ‹è¯•
        function testInit() {
            const initCheck = document.getElementById('init-check');
            const testEditor = document.getElementById('test-editor');
            
            if (typeof Quill === 'undefined') {
                initCheck.innerHTML = '<div class="status error">âŒ æ— æ³•æµ‹è¯•ï¼šQuill åº“æœªåŠ è½½</div>';
                log('åˆå§‹åŒ–æµ‹è¯•å¤±è´¥ï¼šQuill åº“æœªåŠ è½½', 'error');
                return;
            }
            
            try {
                // æ¸…ç©ºå®¹å™¨
                testEditor.innerHTML = '';
                
                // åˆå§‹åŒ–ç¼–è¾‘å™¨
                const quill = new Quill('#test-editor', {
                    theme: 'snow',
                    modules: {
                        toolbar: [
                            ['bold', 'italic'],
                            ['link', 'image']
                        ]
                    },
                    placeholder: 'æµ‹è¯•ç¼–è¾‘å™¨...'
                });
                
                // è®¾ç½®æµ‹è¯•å†…å®¹
                quill.root.innerHTML = '<p><strong>æµ‹è¯•æˆåŠŸï¼</strong>ç¼–è¾‘å™¨å·¥ä½œæ­£å¸¸ã€‚</p>';
                
                initCheck.innerHTML = '<div class="status success">âœ… ç¼–è¾‘å™¨åˆå§‹åŒ–æˆåŠŸï¼ä½ åº”è¯¥èƒ½åœ¨ä¸‹æ–¹çœ‹åˆ°ä¸€ä¸ªå¯ç¼–è¾‘çš„ç¼–è¾‘å™¨ã€‚</div>';
                log('ç¼–è¾‘å™¨åˆå§‹åŒ–æˆåŠŸ');
                
            } catch (error) {
                initCheck.innerHTML = `<div class="status error">âŒ åˆå§‹åŒ–å¤±è´¥: ${error.message}</div>`;
                log(`ç¼–è¾‘å™¨åˆå§‹åŒ–å¤±è´¥: ${error.message}`, 'error');
                console.error('è¯¦ç»†é”™è¯¯ï¼š', error);
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ
        window.addEventListener('load', function() {
            log('é¡µé¢åŠ è½½å®Œæˆ');
            checkEnvironment();
            testCDN();
            
            // å»¶è¿Ÿæ£€æµ‹ Quillï¼Œç­‰å¾…è„šæœ¬åŠ è½½
            setTimeout(() => {
                checkQuill();
            }, 1000);
        });
    </script>
    
    <!-- åŠ è½½ Quill - ä½¿ç”¨ jsDelivr CDN -->
    <link href="https://cdn.jsdelivr.net/npm/quill@1.3.6/dist/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/quill@1.3.6/dist/quill.js"></script>
</body>
</html>
